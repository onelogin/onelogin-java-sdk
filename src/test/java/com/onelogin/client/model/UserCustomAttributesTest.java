/*
 * OneLogin API
 * OpenAPI Specification for OneLogin
 *
 * The version of the OpenAPI document: 3.1.1
 * 
 *
 * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).
 * https://openapi-generator.tech
 * Do not edit the class manually.
 */


package com.onelogin.client.model;

import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import com.onelogin.client.JSON;
import org.junit.jupiter.api.BeforeAll;
import org.junit.jupiter.api.Test;

import java.io.IOException;
import java.util.Map;

import static org.junit.jupiter.api.Assertions.*;

/**
 * Test class for User custom attributes functionality
 */
public class UserCustomAttributesTest {

    @BeforeAll
    public static void setup() {
        // Initialize the JSON helper with Gson configuration
        GsonBuilder builder = JSON.createGson();
        builder.registerTypeAdapterFactory(new User.CustomTypeAdapterFactory());
        Gson gson = builder.create();
        JSON.setGson(gson);
    }
    /**
     * Test that custom attributes can be set and retrieved
     */
    @Test
    public void testSetAndGetCustomAttributes() {
        User user = new User();
        user.setId(12345);
        user.setUsername("testuser");
        user.setEmail("test@example.com");
        
        // Add custom attributes
        user.putCustomAttribute("department_code", "IT-001");
        user.putCustomAttribute("employee_id", "EMP12345");
        user.putCustomAttribute("cost_center", 5000);
        
        // Verify custom attributes can be retrieved
        assertEquals("IT-001", user.getCustomAttribute("department_code"));
        assertEquals("EMP12345", user.getCustomAttribute("employee_id"));
        assertEquals(5000, user.getCustomAttribute("cost_center"));
        
        // Verify getCustomAttributes returns all custom attributes
        Map<String, Object> customAttrs = user.getCustomAttributes();
        assertNotNull(customAttrs);
        assertEquals(3, customAttrs.size());
        assertTrue(customAttrs.containsKey("department_code"));
        assertTrue(customAttrs.containsKey("employee_id"));
        assertTrue(customAttrs.containsKey("cost_center"));
    }

    /**
     * Test that custom attributes are deserialized from JSON
     */
    @Test
    public void testDeserializeCustomAttributes() throws IOException {
        String jsonString = "{\n" +
                "  \"id\": 12345,\n" +
                "  \"username\": \"testuser\",\n" +
                "  \"email\": \"test@example.com\",\n" +
                "  \"firstname\": \"John\",\n" +
                "  \"lastname\": \"Doe\",\n" +
                "  \"department_code\": \"IT-001\",\n" +
                "  \"employee_id\": \"EMP12345\",\n" +
                "  \"cost_center\": 5000,\n" +
                "  \"location\": \"New York\"\n" +
                "}";
        
        User user = User.fromJson(jsonString);
        
        // Verify standard fields
        assertEquals(12345, user.getId());
        assertEquals("testuser", user.getUsername());
        assertEquals("test@example.com", user.getEmail());
        assertEquals("John", user.getFirstname());
        assertEquals("Doe", user.getLastname());
        
        // Verify custom attributes
        assertEquals("IT-001", user.getCustomAttribute("department_code"));
        assertEquals("EMP12345", user.getCustomAttribute("employee_id"));
        assertEquals(5000, ((Number) user.getCustomAttribute("cost_center")).intValue());
        assertEquals("New York", user.getCustomAttribute("location"));
        
        // Verify all custom attributes are captured
        Map<String, Object> customAttrs = user.getCustomAttributes();
        assertNotNull(customAttrs);
        assertEquals(4, customAttrs.size());
    }

    /**
     * Test that custom attributes are serialized to JSON
     */
    @Test
    public void testSerializeCustomAttributes() {
        User user = new User();
        user.setId(12345);
        user.setUsername("testuser");
        user.setEmail("test@example.com");
        user.setFirstname("John");
        user.setLastname("Doe");
        
        // Add custom attributes
        user.putCustomAttribute("department_code", "IT-001");
        user.putCustomAttribute("employee_id", "EMP12345");
        user.putCustomAttribute("cost_center", 5000);
        
        String json = user.toJson();
        
        // Verify JSON contains standard fields
        assertTrue(json.contains("\"id\":12345"));
        assertTrue(json.contains("\"username\":\"testuser\""));
        assertTrue(json.contains("\"email\":\"test@example.com\""));
        
        // Verify JSON contains custom attributes
        assertTrue(json.contains("\"department_code\":\"IT-001\""));
        assertTrue(json.contains("\"employee_id\":\"EMP12345\""));
        assertTrue(json.contains("\"cost_center\":5000"));
    }

    /**
     * Test round-trip serialization/deserialization with custom attributes
     */
    @Test
    public void testRoundTripWithCustomAttributes() throws IOException {
        User originalUser = new User();
        originalUser.setId(12345);
        originalUser.setUsername("testuser");
        originalUser.setEmail("test@example.com");
        originalUser.putCustomAttribute("custom_field_1", "value1");
        originalUser.putCustomAttribute("custom_field_2", 42);
        originalUser.putCustomAttribute("custom_field_3", true);
        
        // Serialize to JSON
        String json = originalUser.toJson();
        
        // Deserialize back to User
        User deserializedUser = User.fromJson(json);
        
        // Verify standard fields match
        assertEquals(originalUser.getId(), deserializedUser.getId());
        assertEquals(originalUser.getUsername(), deserializedUser.getUsername());
        assertEquals(originalUser.getEmail(), deserializedUser.getEmail());
        
        // Verify custom attributes match
        assertEquals("value1", deserializedUser.getCustomAttribute("custom_field_1"));
        assertEquals(42, ((Number) deserializedUser.getCustomAttribute("custom_field_2")).intValue());
        assertEquals(true, deserializedUser.getCustomAttribute("custom_field_3"));
    }

    /**
     * Test that null custom attribute key returns null
     */
    @Test
    public void testGetNonExistentCustomAttribute() {
        User user = new User();
        user.setId(12345);
        
        // Try to get a custom attribute that doesn't exist
        Object value = user.getCustomAttribute("non_existent_field");
        
        assertNull(value);
    }

    /**
     * Test equals and hashCode with custom attributes
     */
    @Test
    public void testEqualsAndHashCodeWithCustomAttributes() {
        User user1 = new User();
        user1.setId(12345);
        user1.setUsername("testuser");
        user1.putCustomAttribute("field1", "value1");
        
        User user2 = new User();
        user2.setId(12345);
        user2.setUsername("testuser");
        user2.putCustomAttribute("field1", "value1");
        
        User user3 = new User();
        user3.setId(12345);
        user3.setUsername("testuser");
        user3.putCustomAttribute("field1", "different_value");
        
        // Users with same custom attributes should be equal
        assertEquals(user1, user2);
        assertEquals(user1.hashCode(), user2.hashCode());
        
        // Users with different custom attributes should not be equal
        assertNotEquals(user1, user3);
    }

    /**
     * Test toString includes custom attributes
     */
    @Test
    public void testToStringWithCustomAttributes() {
        User user = new User();
        user.setId(12345);
        user.setUsername("testuser");
        user.putCustomAttribute("custom_field", "custom_value");
        
        String userString = user.toString();
        
        // Verify toString contains custom attributes
        assertTrue(userString.contains("customAttributes"));
    }
}
